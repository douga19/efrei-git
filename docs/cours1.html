<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Cours 1 - Introduction au versionnage – Versionning et Repository (xin206 - xdev206)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assets/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-36f215d6689654f6cc702cf3f4f6bb39.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="site_libs/quarto-diagram/mermaid.min.js"></script>
<script src="site_libs/quarto-diagram/mermaid-init.js"></script>
<link href="site_libs/quarto-diagram/mermaid.css" rel="stylesheet">


</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    <img src="./assets/logo-noir.png" alt="" class="navbar-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Versionning et Repository (xin206 - xdev206)</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cours" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Cours</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-cours">    
        <li>
    <a class="dropdown-item" href="./cours1.html">
 <span class="dropdown-text">Cours 1 - Introduction au versionnage</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./cours2.html">
 <span class="dropdown-text">Cours 2 - L’historique des commits</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./cours3.html">
 <span class="dropdown-text">Cours 3 - Branches et Fusion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./cours4.html">
 <span class="dropdown-text">Cours 4 - Travailler avec un dépôt distant</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-tps" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">TPs</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-tps">    
        <li>
    <a class="dropdown-item" href="./tp1.html">
 <span class="dropdown-text">TP1 - Premiers pas avec Git</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tp2.html">
 <span class="dropdown-text">TP2 - Explorer l’historique des commits, annuler des modifications</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tp3.html">
 <span class="dropdown-text">TP3 - Branches et Fusion</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./tp4.html">
 <span class="dropdown-text">TP4 - Programming quotes (collaborer sur GitHub)</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Contenu</h2>
   
  <ul>
  <li><a href="#introduction-au-versionnage" id="toc-introduction-au-versionnage" class="nav-link active" data-scroll-target="#introduction-au-versionnage"><span class="header-section-number">1</span> Introduction au versionnage</a>
  <ul class="collapse">
  <li><a href="#pourquoi-le-versionnage" id="toc-pourquoi-le-versionnage" class="nav-link" data-scroll-target="#pourquoi-le-versionnage"><span class="header-section-number">1.1</span> Pourquoi le versionnage ?</a></li>
  <li><a href="#concepts-de-base-du-versionnage" id="toc-concepts-de-base-du-versionnage" class="nav-link" data-scroll-target="#concepts-de-base-du-versionnage"><span class="header-section-number">1.2</span> Concepts de base du versionnage</a></li>
  <li><a href="#outils-de-gestion-de-version" id="toc-outils-de-gestion-de-version" class="nav-link" data-scroll-target="#outils-de-gestion-de-version"><span class="header-section-number">1.3</span> Outils de gestion de version</a></li>
  <li><a href="#types-doutils-de-gestion-de-version" id="toc-types-doutils-de-gestion-de-version" class="nav-link" data-scroll-target="#types-doutils-de-gestion-de-version"><span class="header-section-number">1.4</span> Types d’outils de gestion de version</a>
  <ul class="collapse">
  <li><a href="#outils-de-gestion-de-version-centralisés" id="toc-outils-de-gestion-de-version-centralisés" class="nav-link" data-scroll-target="#outils-de-gestion-de-version-centralisés"><span class="header-section-number">1.4.1</span> Outils de gestion de version centralisés</a></li>
  <li><a href="#outils-de-gestion-de-version-décentralisés" id="toc-outils-de-gestion-de-version-décentralisés" class="nav-link" data-scroll-target="#outils-de-gestion-de-version-décentralisés"><span class="header-section-number">1.4.2</span> Outils de gestion de version décentralisés</a></li>
  </ul></li>
  <li><a href="#git" id="toc-git" class="nav-link" data-scroll-target="#git"><span class="header-section-number">1.5</span> Git</a>
  <ul class="collapse">
  <li><a href="#utiliser-git-en-ligne-de-commande" id="toc-utiliser-git-en-ligne-de-commande" class="nav-link" data-scroll-target="#utiliser-git-en-ligne-de-commande"><span class="header-section-number">1.5.1</span> Utiliser Git en ligne de commande</a></li>
  <li><a href="#comment-git-enregistre-t-il-les-fichiers" id="toc-comment-git-enregistre-t-il-les-fichiers" class="nav-link" data-scroll-target="#comment-git-enregistre-t-il-les-fichiers"><span class="header-section-number">1.5.2</span> Comment Git enregistre-t-il les fichiers ?</a></li>
  <li><a href="#les-commandes-de-base-de-git" id="toc-les-commandes-de-base-de-git" class="nav-link" data-scroll-target="#les-commandes-de-base-de-git"><span class="header-section-number">1.5.3</span> Les commandes de base de Git</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Cours 1 - Introduction au versionnage</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction-au-versionnage" class="level1" data-number="1">
<h1 data-number="1"><span class="header-section-number">1</span> Introduction au versionnage</h1>
<p>Le <em>versionnage</em> ou la <em>gestion de version</em> (<em>version control</em> en anglais) est un processus qui consiste à enregistrer les modifications apportées à un fichier ou un ensemble de fichiers au fil du temps afin de pouvoir y accéder ultérieurement. Le versionnage est utilisé dans de nombreux domaines, notamment le développement logiciel, la gestion de projet, la gestion de contenu, etc.</p>
<p>Dans le cadre du développement logiciel, cette pratique permet de suivre l’évolution d’un projet de manière organisée et collaborative.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Définitions
</div>
</div>
<div class="callout-body-container callout-body">
<p>Le <em>versionnage</em> est un processus qui consiste à enregistrer les modifications apportées à un fichier ou un ensemble de fichiers au fil du temps afin de pouvoir y accéder ultérieurement.</p>
<p>Une <em>version</em> est l’état d’un fichier ou d’un ensemble de fichiers à un moment donné.</p>
</div>
</div>
<section id="pourquoi-le-versionnage" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="pourquoi-le-versionnage"><span class="header-section-number">1.1</span> Pourquoi le versionnage ?</h2>
<p>Le versionnage permet de répondre à plusieurs besoins essentiels dans le développement logiciel, notamment:</p>
<ul>
<li><strong>Gestion des modifications</strong> : Le versionnage permet de suivre les modifications apportées au code source d’un projet. Il permet de répondre à des questions telles que :
<ul>
<li>Quels sont les changements apportés au code source ?</li>
<li>Quand ont-ils été apportés ?</li>
<li>Qui les a apportés ?</li>
<li>Pourquoi ont-ils été apportés ? etc.</li>
</ul></li>
<li><strong>Collaboration</strong> : Le versionnage permet à plusieurs développeurs de travailler sur le même projet en même temps. Il permet de répondre à des questions telles que :
<ul>
<li>Comment les développeurs peuvent-ils travailler ensemble sur le même projet ?</li>
<li>Comment peuvent-ils partager leurs modifications ?</li>
<li>Comment peuvent-ils fusionner leurs modifications ? etc.</li>
</ul></li>
<li><strong>Traçabilité</strong> : Le versionnage permet de suivre l’évolution d’un projet au fil du temps. Il permet de répondre à des questions telles que :
<ul>
<li>Quels sont les changements apportés au projet ?</li>
<li>Quand ont-ils été apportés ?</li>
<li>Qui les a apportés ?</li>
<li>Pourquoi ont-ils été apportés ? etc.</li>
</ul></li>
<li><strong>Sauvegarde</strong> : Le versionnage permet de sauvegarder les modifications apportées au code source d’un projet. Il permet de répondre à des questions telles que :
<ul>
<li>Comment revenir à une version antérieure du projet ?</li>
<li>Comment récupérer une version supprimée du projet ? etc.</li>
</ul></li>
<li><strong>Reproductibilité</strong> : Le versionnage permet de reproduire un projet dans un état donné. Il permet de répondre à des questions telles que :
<ul>
<li>Comment reproduire un projet dans un état donné ?</li>
<li>Comment reproduire un projet dans un état donné à une date donnée ? etc.</li>
</ul></li>
<li><strong>Bonnes pratiques</strong> : Le versionnage permet d’appliquer des bonnes pratiques de développement logiciel. Il permet de répondre à des questions telles que :
<ul>
<li>Comment maintenir un historique de version propre et organisé ?</li>
<li>Comment documenter les modifications apportées au code source ? etc.</li>
</ul></li>
</ul>
</section>
<section id="concepts-de-base-du-versionnage" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="concepts-de-base-du-versionnage"><span class="header-section-number">1.2</span> Concepts de base du versionnage</h2>
<p>Le versionnage est basé sur les concepts essentiels suivants :</p>
<ul>
<li><strong>Dépôt (Repository)</strong> : Un dépôt est un espace de stockage qui contient les fichiers d’un projet ainsi que l’historique des modifications apportées à ces fichiers. Il peut être local ou distant.</li>
<li><strong>Commit</strong> : Un commit est une modification apportée à un ou plusieurs fichiers d’un projet. Il est identifié par un identifiant unique appelé <em>hash</em>.</li>
<li><strong>Historique des commits (Commit tree)</strong> : L’historique des commits est la liste des commits qui ont été apportés à un projet. Il permet de suivre l’évolution d’un projet au fil du temps.</li>
<li><strong>Branche (Branch)</strong> : Une branche est une ligne de développement indépendante. Elle permet de travailler sur une fonctionnalité ou une modification sans affecter la branche principale du projet.</li>
<li><strong>Fusion (Merge)</strong> : Une fusion est l’opération qui consiste à intégrer les modifications apportées à une branche dans une autre branche.</li>
</ul>
<p>Le graphique suivant illustre ces concepts : <!-- ![Concepts de base du versionnage](../../assets/img/commit-tree.png) --> <img src="assets/commit-tree.png" alt="Concepts de base du versionnage" height="400px"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Vocabulaire
</div>
</div>
<div class="callout-body-container callout-body">
<p>Les termes suivants sont couramment utilisés dans le contexte du versionnage :</p>
<ul>
<li><strong>Dépôt distant (Remote repository)</strong> : Un dépôt distant est un dépôt qui est stocké sur un serveur distant. Il permet de partager les modifications apportées à un projet avec d’autres développeurs.</li>
<li><strong>Dépôt local (Local repository)</strong> : Un dépôt local est un dépôt qui est stocké sur la machine d’un développeur. Il permet de travailler sur un projet sans connexion à un serveur distant.</li>
<li><strong>Clone</strong> : Un clone est une copie d’un dépôt distant sur un dépôt local. Il permet de travailler sur un projet sans connexion à un serveur distant.</li>
<li><strong>Pull</strong> : Un pull est l’opération qui consiste à récupérer les modifications apportées à un dépôt distant et les fusionner avec un dépôt local.</li>
<li><strong>Push</strong> : Un push est l’opération qui consiste à envoyer les modifications apportées à un dépôt local vers un dépôt distant.</li>
<li><strong>Pull request</strong> : Une pull request est une demande de fusion de modifications apportées à un dépôt distant. Elle permet de demander à un propriétaire de dépôt de fusionner les modifications apportées à un dépôt distant avec le dépôt d’origine.</li>
<li><strong>Tag</strong> : Un tag est un identifiant symbolique qui permet de marquer un commit. Il est généralement utilisé pour marquer les versions stables d’un projet.</li>
<li><strong>Conflit</strong> : Un conflit est une situation dans laquelle deux modifications concurrentes affectent le même fichier. Il nécessite une intervention manuelle pour être résolu.</li>
</ul>
</div>
</div>
</section>
<section id="outils-de-gestion-de-version" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="outils-de-gestion-de-version"><span class="header-section-number">1.3</span> Outils de gestion de version</h2>
<p>Pour mettre en place un processus de versionnage, il est nécessaire d’utiliser un outil de gestion de version.</p>
<p>Un <em>outil de gestion de version</em> est un logiciel qui permet de gérer les différentes versions d’un ensemble de fichiers (code source, documentation, etc.). Les outils de gestion de version sont couramment utilisés dans les projets de développement de logiciels pour suivre les modifications apportées au code source et pour faciliter la collaboration entre les membres d’une équipe.</p>
<p>Ils permmettent d’appliquer plus ou moins les principes essentiels du versionnage: stocker chaque version d’un fichier, d’enregistrer les modifications apportées à chaque version, de fusionner des versions différentes, de suivre l’historique des modifications, de revenir en arrière sur une version antérieure, et de travailler en collaboration avec d’autres personnes.</p>
</section>
<section id="types-doutils-de-gestion-de-version" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="types-doutils-de-gestion-de-version"><span class="header-section-number">1.4</span> Types d’outils de gestion de version</h2>
<p>Il existe deux types d’outils de gestion de version : les outils de gestion de version dits <em>centralisés</em> et les outils de gestion de version dits <em>décentralisés</em>.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Remarque
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dans ce cours nous allons utiliser l’outil de gestion de version décentralisé <a href="https://git-scm.com/">Git</a>. Mais il est tout de même important de comprendre les différences entre les deux types d’outils.</p>
</div>
</div>
<section id="outils-de-gestion-de-version-centralisés" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="outils-de-gestion-de-version-centralisés"><span class="header-section-number">1.4.1</span> Outils de gestion de version centralisés</h3>
<p>Les outils de gestion de version centralisés sont basés sur un modèle client-serveur. Ils utilisent un dépôt centralisé pour stocker les fichiers d’un projet et l’historique des modifications apportées à ces fichiers.</p>
<ul>
<li>Les développeurs travaillent sur une copie locale du dépôt centralisé.</li>
<li>Ils peuvent récupérer les modifications apportées au dépôt centralisé et les fusionner avec leur copie locale.</li>
<li>Ils peuvent également envoyer les modifications apportées à leur copie locale vers le dépôt centralisé.</li>
</ul>
<p>Les outils de gestion de version centralisés les plus populaires sont <em>Subversion (SVN)</em>, <em>Perforce</em>, et <em>ClearCase</em>.</p>
<p>Le graphique suivant illustre le fonctionnement d’un outil de gestion de version centralisé :</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">graph LR
    A[Alice] -- Push --&gt; B((Dépôt centralisé))
    B -- Pull --&gt; A
    C[Bob] -- Push --&gt; B
    B -- Pull --&gt; C
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p><em>Alice et Bob travaillent sur le même projet dont la gestion de version se fait par un outil de gestion de version centralisé</em></p>
<section id="comment-ça-marche" class="level4" data-number="1.4.1.1">
<h4 data-number="1.4.1.1" class="anchored" data-anchor-id="comment-ça-marche"><span class="header-section-number">1.4.1.1</span> Comment ça marche ?</h4>
<ol type="1">
<li>Alice effectue un changement puis elle envoie ses modifications vers le dépôt central.</li>
<li>Le dépôt central est mis à jour.</li>
<li>Bob récupère la dernière version du projet (qui intègre les changements d’Alice) en mettant à jour sa copie locale du dépôt central.</li>
<li>Si il y a des conflits, Bob doit les résoudre manuellement avant de pouvoir envoyer ses modifications.</li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Avantages
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Contrôle centralisé</strong> : Un seul dépôt central offre un contrôle plus strict sur les modifications et les versions.</li>
<li><strong>Visibilité globale</strong> : Facilité de suivi des changements, historique global des versions et gestion des conflits simplifiée.</li>
<li><strong>Collaboration facilitée</strong> :Les équipes travaillent sur la même base de code, favorisant la collaboration et la cohérence du projet.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Inconvénients
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Dépendance au serveur central</strong> : En cas de panne du serveur central, l’accès aux versions et la collaboration peuvent être perturbés.</li>
<li><strong>Branchements complexes</strong> : La gestion de branches peut être plus complexe, avec un risque accru de conflits lors des fusions.</li>
<li><strong>Performance dépendante du réseau</strong> : L’accès et la performance peuvent être affectés si l’équipe travaille à distance ou avec une connexion lente.</li>
<li><strong>Impossibilité de travailler hors ligne</strong> : Les développeurs ne peuvent pas travailler hors ligne, ce qui peut être un problème pour les équipes distribuées.</li>
</ul>
</div>
</div>
</section>
</section>
<section id="outils-de-gestion-de-version-décentralisés" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="outils-de-gestion-de-version-décentralisés"><span class="header-section-number">1.4.2</span> Outils de gestion de version décentralisés</h3>
<p>On parle aussi d’outil de gestion <em>distribué</em>.</p>
<ul>
<li>Ils utilisent un <strong>dépôt local</strong> pour stocker les fichiers d’un projet et l’historique des modifications apportées à ces fichiers.</li>
<li>Les développeurs travaillent sur une <strong>copie locale</strong> du dépôt distant. Ils peuvent récupérer les modifications apportées au dépôt distant et les fusionner avec leur copie locale.</li>
<li>Ils peuvent également envoyer les modifications apportées à leur copie locale vers le dépôt distant.</li>
</ul>
<p>Les outils de gestion de version décentralisés les plus populaires sont <em>Git</em> et <em>Mercurial</em></p>
<p>Le graphique suivant illustre le fonctionnement d’un outil de gestion de version décentralisé :</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">    graph LR
        A[Dépôt local d'Alice] -- Push --&gt; B((Dépôt distant))
        B -- Pull --&gt; A
        C[Dépôt local de Bob] -- Push --&gt; B
        B -- Pull --&gt; C
        D[Alice] -- Commit --&gt; A
        E[Bob] -- Commit --&gt; C
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<section id="comment-ça-marche-1" class="level4" data-number="1.4.2.1">
<h4 data-number="1.4.2.1" class="anchored" data-anchor-id="comment-ça-marche-1"><span class="header-section-number">1.4.2.1</span> Comment ça marche ?</h4>
<ol type="1">
<li>Alice effectue un changement puis elle soumet ses modifications dans son dépôt local.</li>
<li>Elle pousse (push) ces modification vers le dépôt distant.</li>
<li>Le dépôt distant est mis à jour.</li>
<li>Bob récupère la dernière version du projet (qui intègre les changements d’Alice) en mettant à jour son dépôt local par rapport au dépôt distant. (pull)</li>
</ol>
<p>C’est comme si chacun avait son propre dépôt centralisé.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Avantages
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Travail en mode déconnecté :</strong> Les développeurs peuvent travailler en mode déconnecté sans être connectés en permanence à un serveur central.</li>
<li><strong>Meilleure sécurité :</strong> Les copies locales des fichiers sont stockées sur l’ordinateur du développeur, ce qui rend le système plus sûr et plus résistant aux attaques.</li>
<li><strong>Meilleure flexibilité :</strong> Les développeurs peuvent facilement créer des branches, expérimenter et fusionner des modifications sans affecter le code source principal.</li>
<li><strong>Performances améliorées :</strong> Les opérations locales sont beaucoup plus rapides que les opérations de synchronisation avec un serveur central.</li>
</ul>
</div>
</div>
<div class="callout callout-style-default callout-caution callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Inconvénients
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li><strong>Complexité accrue :</strong> Les développeurs doivent apprendre à gérer les dépôts locaux et distants, ce qui peut être plus complexe.</li>
<li><strong>Visibilité limitée :</strong> Les développeurs ne peuvent pas voir les modifications apportées par d’autres développeurs tant qu’ils n’ont pas synchronisé leurs dépôts locaux avec le dépôt distant.</li>
<li><strong>Gestion des conflits plus complexe :</strong> Les conflits peuvent être plus difficiles à gérer, car les développeurs doivent les résoudre localement avant de les pousser vers le dépôt distant.</li>
</ul>
</div>
</div>
</section>
</section>
</section>
<section id="git" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="git"><span class="header-section-number">1.5</span> Git</h2>
<p>Dans ce cours, nous allons mettre en pratique les concepts de base du versionnage en utilisant l’outil de gestion de version décentralisé <a href="https://git-scm.com/">Git</a>. Il est actuellement l’outil de gestion de version le plus utilisé, en particulier dans les projets open source, grâce à sa facilité d’utilisation, sa rapidité et sa flexibilité.</p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Git a été créé en 2005 par Linus Torvalds, le créateur du noyau Linux. À l’époque, il cherchait un outil de gestion de version pour le développement du noyau Linux, mais n’était pas satisfait des outils existants tels que BitKeeper.</p>
<p>Torvalds a donc décidé de créer son propre outil de gestion de version, en s’appuyant sur les principes de conception du noyau Linux.</p>
<p>Le développement de Git a été principalement motivé par la nécessité de gérer efficacement le code source du noyau Linux, qui est un projet très complexe et en constante évolution avec des milliers de développeurs à travers le monde.</p>
<p>Au fil des ans, Git est devenu de plus en plus populaire auprès des développeurs et des entreprises. En 2008, le projet Git a été adopté par la communauté open-source et est rapidement devenu un outil de gestion de version standard pour de nombreux projets open-source.</p>
<p>Aujourd’hui, Git est largement utilisé dans l’industrie du développement de logiciels pour la gestion de versions de code source, la collaboration en équipe, et l’intégration continue. Les plateformes d’hébergement de code source telles que <a href="https://github.com/">GitHub</a>, <a href="https://about.gitlab.com/">GitLab</a> et <a href="https://bitbucket.org/">Bitbucket</a> sont devenues des outils incontournables pour les projets de développement de logiciels, en grande partie grâce à l’adoption massive de Git.</p>
</div>
</div>
<section id="utiliser-git-en-ligne-de-commande" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="utiliser-git-en-ligne-de-commande"><span class="header-section-number">1.5.1</span> Utiliser Git en ligne de commande</h3>
<p>Il existe de nombreuses manières différentes d’utiliser Git. Il y a les outils originaux en ligne de commande et il y a de nombreuses interfaces graphiques avec des capacités variables. La plupart des IDE récents intègre déjà l’utilisation d’outils gestion de version.</p>
<p>Dans ce cours, nous utiliserons Git en ligne de commande.</p>
<ul>
<li>Tout d’abord, la ligne de commande est la seule interface qui permet de lancer toutes les commandes Git (la plupart des interfaces graphiques simplifient l’utilisation en ne couvrant qu’un sous-ensemble des fonctionnalités de Git).</li>
<li>Si vous savez comment utiliser la version en ligne de commande, vous serez à même de comprendre comment fonctionne la version graphique, tandis que l’inverse n’est pas nécessairement vrai.</li>
<li>De plus, le choix d’un outil graphique est sujet à des goûts personnels, mais tous les utilisateurs auront les commandes installées et utilisables.</li>
</ul>
<p>Toutes les commandes Git s’utilisent de la manière suivante:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> <span class="op">&lt;</span>commande<span class="op">&gt;</span> <span class="pp">[</span><span class="ss">options</span><span class="pp">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Il faudra alors taper dans un terminal <code>git</code> suivi du nom de la commande et éventuellement suivis d’autres <em>options</em> que nous allons voir plus tard.</p>
<p>Par exemple la commande <code>init</code> qui permet d’initialiser un dépôt Git et s’utilise de la manière suivante:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">git</span> init</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<ul>
<li>Dans toute la suite de ce cours, <strong>surtout en TP</strong>, nous allons utiliser Git en ligne de commande. Pour ce faire, vous devez ouvrir un terminal sur votre machine.
<ul>
<li>Si vous êtes sur Windows, vous pouvez utiliser Git Bash pour exécuter les commandes Git.</li>
<li>Si vous êtes sur Linux ou Mac, vous pouvez utiliser le terminal intégré à votre système d’exploitation.</li>
</ul></li>
<li>Devant chaque commande, vous verrez le symbole <code>$</code>. Ce symbole représente le prompt de votre terminal. Vous ne devez pas le copier lorsque vous exécutez les commandes Git.</li>
<li>Les lignes de commandes précédées du symbole <code>#</code> sont des commentaires. Vous ne devez pas les copier lorsque vous exécutez les commandes.</li>
</ul>
</div>
</div>
</section>
<section id="comment-git-enregistre-t-il-les-fichiers" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="comment-git-enregistre-t-il-les-fichiers"><span class="header-section-number">1.5.2</span> Comment Git enregistre-t-il les fichiers ?</h3>
<p>Une fois que vous avez créé un dépôt Git, l’outil va créer un répertoire <code>.git</code> qui contient tous les fichiers nécessaires au fonctionnement de Git. Ce répertoire est appelé <em>dépôt Git</em> ou <em>dépôt local</em>. <strong>Il est très important de ne pas modifier ou supprimer ce répertoire</strong>.</p>
<p>Git va alors retracer l’historique des modifications apportées aux fichiers du projet en travaillant avec trois zones différentes:</p>
<ul>
<li><em>la zone de travail (working directory)</em>
<ul>
<li>c’est le répertoire dans lequel sont stockés physiquement vos fichiers. C’est le répertoire dans lequel vous travaillez.</li>
</ul></li>
<li><em>la zone d’index (staging area)</em>
<ul>
<li>c’est une zone intermédiaire entre la zone de travail et la zone de dépôt.</li>
<li>elle permet de marquer les modifications à envoyer lors du prochain commit.</li>
<li>elle est matérialisée dans <code>.git/index</code></li>
</ul></li>
<li><em>la zone de dépôt (git repository)</em>
<ul>
<li>c’est le répertoire dans lequel sont stockés les fichiers de votre projet tels qu’ils étaient lors de votre dernier commit.</li>
<li>Dans ce répertoire, Git stocke l’historique des modifications apportées à votre projet.</li>
</ul></li>
</ul>
<p>Les différentes commandes Git permettent de passer d’une zone à une autre. On peut voir le dépôt Git comme étant une base de données qui garde de manière compressée toutes les versions (que vous voulez que Git conserve) de votre projet. Le diagramme suivant montre comment passer un fichier d’une zone à une autre.</p>
<div class="cell" data-layout-align="default">
<div class="cell-output-display">
<div>
<p></p><figure class="figure"><p></p>
<div>
<pre class="mermaid mermaid-js">stateDiagram-v2
    s1 : Git repository
    s2 : Staging area
    s3 : Working directory
    s1 --&gt; s2 : git reset
    s2 --&gt; s1 : git commit
    s2 --&gt; s3 : git checkout
    s3 --&gt; s2 : git add
</pre>
</div>
<p></p></figure><p></p>
</div>
</div>
</div>
<p>La commande <code>git status</code> permet savoir quels fichiers sont différents d’une zone à une autre.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode bash code-with-copy"><code class="sourceCode bash"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> git status</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="co"># On branch main</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Changes to be committed:</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   (use "git reset HEAD ..." to unstage)</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co">#   modified:   accounts/forms.py</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co">#   modified:   accounts/models.py</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Changes not staged for commit:</span></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co">#   (use "git add ..." to update what will be committed)</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   (use "git checkout -- ..." to discard changes in working directory)</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co">#   modified:   accounts/urls.py</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a><span class="co">#   modified:   accounts/views.py</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Ici, la réponse de <code>git status</code> indique par exemple que les fichiers:</p>
<ul>
<li><code>accounts/forms.py</code> et <code>accounts/models.py</code> sont indexés dans la zone de staging et attendent d’être ajouté dans le dépôt.</li>
<li><code>accounts/urls.py</code> et <code>accounts/views.py</code> ne sont pas encore dans la zone de staging et attendent d’y être ajoutés.</li>
</ul>
<p>Le processus usuel est donc le suivant:</p>
<ul>
<li>On crée/modifie un fichier dans la zone de travail</li>
<li>On l’ajoute dans la zone d’index avec <code>git add</code>.</li>
<li>Ensuite, on soumets les modifications apportés au dépôt git avec <code>git commit</code>.</li>
</ul>
</section>
<section id="les-commandes-de-base-de-git" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="les-commandes-de-base-de-git"><span class="header-section-number">1.5.3</span> Les commandes de base de Git</h3>
<p>Voici les commandes de base de Git dans diverses situations telles qu’elles sont listées dans l’accueil de l’outil :</p>
<p><strong>Démarrer un dépôt Git</strong></p>
<ul>
<li><code>clone</code> Cloner un dépôt dans un nouveau répertoire</li>
<li><code>init</code> Créer un dépôt Git vide ou réinitialiser un existant</li>
</ul>
<p><strong>Tavailler sur la modification actuelle</strong></p>
<ul>
<li><code>add</code> Ajouter le contenu de fichiers dans l’index
<ul>
<li><code>add -u</code> ajouter tous les fichiers modifiés et supprimés (mais pas les “untracked”)</li>
</ul></li>
<li><code>mv</code> Déplacer ou renommer un fichier, un répertoire, ou un lien symbolique</li>
<li><code>restore</code> Restaurer des fichiers</li>
<li><code>rm</code> Supprimer des fichiers de la copie de travail et de l’index</li>
</ul>
<p><strong>Examiner l’historique et l’état du dépôt</strong></p>
<ul>
<li><code>diff</code> Afficher les changements entre les commits</li>
<li><code>log</code> Afficher l’historique des commits</li>
<li><code>status</code> Afficher l’état de la répertoire de travail</li>
</ul>
<p><strong>Agrandir, marquer et modifier votre historique</strong></p>
<ul>
<li><code>branch</code> Lister, créer ou supprimer des branches</li>
<li><code>commit</code> Enregistrer les modifications dans le dépôt</li>
<li><code>merge</code> Fusionner deux ou plusieurs historiques de développement ensemble</li>
<li><code>rebase</code> Déplacer un ensemble de commits vers un autre point de base</li>
<li><code>reset</code> Réinitialiser la HEAD courante à l’état spécifié</li>
<li><code>switch</code> Basculer de branche</li>
</ul>
<p><strong>Collaborer</strong></p>
<ul>
<li><code>fetch</code> Télécharger les objets et références depuis un autre dépôt</li>
<li><code>pull</code> Rapatrier et intégrer un historique depuis un dépôt distant</li>
<li><code>push</code> Pousser l’histoire local vers un dépôt distant</li>
</ul>
<p><strong>Si l’on ne se souvient pas de toutes les commandes</strong></p>
<ul>
<li><code>help</code> Affiche l’aide</li>
</ul>
<p>Un aide mémoire est également à votre disposition <a href="https://training.github.com/downloads/fr/github-git-cheat-sheet.pdf">ici</a>.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Dans le premier TP associé à ce cours, nous allons installer, configurer Git et faire nos premiers pas avec l’outil.</p>
</div>
</div>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>